# ---
# jupyter:
#   jupytext:
#     text_representation:
#       extension: .py
#       format_name: percent
#       format_version: '1.3'
#       jupytext_version: 1.15.2
#   kernelspec:
#     display_name: Python 3 (ipykernel)
#     language: python
#     name: python3
# ---

# %%
from typing import Optional, Any
import math

import torch
from torch import nn, Tensor
from torch.nn import functional as F
from torch.nn.modules import MultiheadAttention, Linear, Dropout, BatchNorm1d, TransformerEncoderLayer

import sys, os, glob

# from sktime.utils import load_data
# from datasets import utils
import numpy as np
import pandas as pd

# %%
from datasets import utils

# %%
# # !pip3 install sktime
import sktime
import sktime.datasets
# # !pip3 install packaging==24.1
from sktime.datasets import load_from_tsfile_to_dataframe

# %%
import datasets

datasets.__version__


# %%
def surface_area_of_cube(edge_length: float) -> str:
    return f"The surface area of the cube is {6 * edge_length ** 2}."


# %%
transform_database = "/Users/hn/Documents/01_research_data/MVTS_transformers/"
Monash_regress_dir = transform_database + "Monash_UEA_UCR_Regression_Archive/"

# %%
sorted(os.listdir(Monash_regress_dir))

# %%
data_paths = sorted(glob.glob(os.path.join(Monash_regress_dir, '*')))  # list of all paths
data_paths

# %%

# %%
from datasets import utils
ii = 15
print (data_paths[ii].split("/")[-1])
train_ts = [x for x in os.listdir(data_paths[ii]) if "train" in x.lower()][0]
print (train_ts)
df, labels = sktime.datasets.load_from_tsfile_to_dataframe(data_paths[ii] + "/"+ train_ts, 
                                                           return_separate_X_and_y=True, 
                                                           replace_missing_vals_with='NaN')

# %%
test_ts = [x for x in os.listdir(data_paths[ii]) if "test" in x.lower()][0]
print (test_ts)
df_test, labels_test = sktime.datasets.load_from_tsfile_to_dataframe(data_paths[ii] + "/"+ test_ts, 
                                                                      return_separate_X_and_y=True, 
                                                                      replace_missing_vals_with='NaN')

# %%
data_paths[ii] + "/"+ test_ts

# %%
A = sktime.datasets.load_from_tsfile_to_dataframe(data_paths[ii] + "/"+ test_ts, 
                                                                      return_separate_X_and_y=False, 
                                                                      replace_missing_vals_with='NaN')

# %%

# %%
type(df["dim_0"][0])

# %%
print (f"{len(labels) = }")
labels

# %%
cell_1_ts_len = len(df['dim_0'][0])
cols = df.columns

# %%
for idx in df.index:
    for a_col in cols:
        if len(df.loc[idx, a_col]) != cell_1_ts_len:
            print (idx, a_col)

# %%
for idx in df_test.index:
    for a_col in cols:
        if len(df_test.loc[idx, a_col]) != cell_1_ts_len:
            print (idx, a_col)

# %%
from collections import OrderedDict

# Create an OrderedDict
ordered_dict = OrderedDict()
ordered_dict['a'] = 1
ordered_dict['b'] = 2
ordered_dict['c'] = 3

# Iterate in insertion order
for key, value in ordered_dict.items():
    print(key, value)

# %%
ordered_dict.keys()

# %%

# %%
a = [1, 2, 3]
a

# %%
np.array(a + [float('nan')] * 2).shape

# %%

# %%
np.array([per_batch[key] + [float("nan")] * (max_len_ - len(val))])

# %%
a = np.array([[1], [2], [3]])
a.shape

# %%
a

# %%
dict_ = dict{"a" : [1, 2],
            "b" : [1, 2, 3]}


# %%
import numpy as np

dir_ = "/Users/hn/Documents/"
arr1 = np.array([1, 2])
arr2 = np.array([4, 5, 6])
np.savez(dir_ + 'my_arrays.npz', array1=arr1, array2=arr2)

# %%
loaded_data = np.load(dir_ + 'my_arrays.npz')
print(loaded_data.files)
print(loaded_data['array1'])
print(loaded_data['array2'])

# %%
a = [np.array([[266. ],
       [255. ],
       [193. ],
       [ 81. ],
       [ 65. ],
       [ 70. ],
       [102. ],
       [218. ],
       [223. ],
       [204. ],
       [176. ],
       [137.5],
       [138. ],
       [134. ],
       [116. ],
       [132. ],
       [113. ],
       [122. ],
       [139. ],
       [163. ],
       [174. ],
       [151. ],
       [137. ],
       [125. ],
       [102. ],
       [176. ],
       [161. ],
       [152. ],
       [133. ],
       [ 98. ],
       [154. ],
       [147. ],
       [124. ],
       [ 96. ],
       [172. ],
       [217. ],
       [187. ],
       [167. ],
       [149. ],
       [127. ],
       [107. ],
       [230. ],
       [136. ],
       [130. ],
       [131. ],
       [ 75. ],
       [ 99. ],
       [ 90. ],
       [163. ],
       [133. ],
       [ 81. ],
       [103. ],
       [ 84. ],
       [227. ],
       [169. ],
       [122. ],
       [120. ],
       [170. ],
       [193. ],
       [209. ],
       [243. ],
       [167. ],
       [181. ],
       [115. ]]), np.array([[125.],
       [116.],
       [ 64.],
       [ 85.],
       [113.],
       [124.],
       [170.],
       [154.],
       [168.],
       [228.],
       [170.],
       [118.],
       [100.],
       [109.],
       [100.],
       [105.],
       [108.],
       [100.],
       [164.],
       [167.],
       [196.],
       [218.],
       [160.],
       [136.],
       [109.],
       [118.],
       [100.],
       [ 98.],
       [ 92.],
       [ 97.],
       [113.],
       [123.],
       [134.],
       [231.],
       [140.],
       [226.],
       [206.],
       [153.],
       [155.],
       [119.],
       [174.],
       [139.],
       [103.],
       [103.],
       [148.],
       [182.],
       [178.],
       [103.],
       [123.],
       [149.],
       [260.],
       [232.],
       [154.],
       [206.],
       [205.],
       [108.],
       [132.],
       [189.],
       [198.],
       [ 70.],
       [153.],
       [191.],
       [ 68.],
       [ 66.]]), np.array([[ 94. ],
       [ 96. ],
       [ 93. ],
       [150.5],
       [140.5],
       [103.5],
       [ 96. ],
       [ 91. ],
       [ 71. ],
       [ 65. ],
       [102. ],
       [135. ],
       [108.5],
       [ 84.5],
       [ 83. ],
       [ 78. ],
       [ 71. ],
       [ 59. ],
       [ 96. ],
       [149.5],
       [106. ],
       [115.5],
       [110. ],
       [ 81. ],
       [ 73. ],
       [130.5],
       [ 95. ],
       [ 76. ],
       [ 66. ],
       [101. ],
       [123.5],
       [ 91. ],
       [ 80. ],
       [ 69. ],
       [ 59. ],
       [ 65. ],
       [ 92. ],
       [ 92. ],
       [115. ],
       [ 95.5],
       [ 90. ],
       [ 78. ],
       [ 66. ],
       [ 84. ],
       [149.5],
       [138. ],
       [131. ],
       [ 90. ],
       [ 72. ],
       [ 64. ],
       [ 94.5],
       [ 91. ],
       [138. ],
       [113. ],
       [ 98. ],
       [ 67. ],
       [ 95. ],
       [131. ],
       [105. ],
       [ 87. ],
       [ 93. ],
       [ 91. ],
       [139.5],
       [100.5]]), np.array([[ 82.  ],
       [ 75.  ],
       [ 62.  ],
       [ 94.  ],
       [174.5 ],
       [123.  ],
       [ 93.  ],
       [ 86.  ],
       [ 70.  ],
       [ 65.  ],
       [ 88.  ],
       [ 87.  ],
       [ 88.  ],
       [152.  ],
       [109.5 ],
       [ 95.5 ],
       [ 91.  ],
       [ 68.  ],
       [ 98.  ],
       [ 97.  ],
       [140.  ],
       [152.5 ],
       [131.5 ],
       [117.  ],
       [120.5 ],
       [ 94.  ],
       [ 77.  ],
       [ 70.  ],
       [ 77.  ],
       [ 98.5 ],
       [105.5 ],
       [102.25],
       [102.25],
       [105.  ],
       [104.75],
       [106.25],
       [ 99.33],
       [137.67],
       [107.33],
       [ 95.67],
       [114.33],
       [103.  ],
       [117.67],
       [113.  ],
       [127.67],
       [111.33],
       [121.33],
       [106.  ],
       [158.67],
       [146.  ],
       [141.33],
       [140.67],
       [132.33],
       [124.  ],
       [125.67],
       [ 99.33],
       [113.33],
       [122.67],
       [128.67],
       [123.33],
       [ 74.5 ],
       [ 74.  ],
       [ 71.5 ],
       [ 67.  ]]), np.array([[ 59.  ],
       [ 59.5 ],
       [ 56.  ],
       [ 54.5 ],
       [ 57.  ],
       [ 58.  ],
       [ 55.  ],
       [ 56.  ],
       [ 66.5 ],
       [105.  ],
       [117.5 ],
       [119.5 ],
       [113.5 ],
       [ 93.  ],
       [ 83.5 ],
       [ 71.  ],
       [ 57.  ],
       [ 60.5 ],
       [ 64.  ],
       [ 61.  ],
       [ 67.5 ],
       [ 73.5 ],
       [139.  ],
       [126.5 ],
       [ 89.  ],
       [ 82.  ],
       [ 72.5 ],
       [ 68.5 ],
       [ 66.  ],
       [ 60.  ],
       [ 64.  ],
       [ 60.5 ],
       [ 62.  ],
       [ 95.  ],
       [124.  ],
       [113.  ],
       [104.5 ],
       [102.5 ],
       [ 89.5 ],
       [ 98.  ],
       [ 93.  ],
       [ 97.  ],
       [107.  ],
       [103.75],
       [131.75],
       [134.25],
       [113.5 ],
       [103.5 ],
       [109.75],
       [145.75],
       [150.75],
       [150.25],
       [126.  ],
       [132.33],
       [112.67],
       [121.  ],
       [114.67],
       [ 98.  ],
       [ 94.5 ],
       [132.5 ],
       [114.  ],
       [112.  ],
       [107.5 ],
       [105.  ]]), np.array([[ 94.5 ],
       [101.5 ],
       [ 89.  ],
       [ 99.5 ],
       [148.  ],
       [122.67],
       [131.67],
       [ 79.  ],
       [121.33],
       [ 92.33],
       [ 87.33],
       [ 77.33],
       [ 84.5 ],
       [ 78.  ],
       [ 88.  ],
       [115.67],
       [102.67],
       [ 67.  ],
       [ 90.33],
       [ 59.  ],
       [ 76.67],
       [ 93.  ],
       [ 76.5 ],
       [ 82.5 ],
       [ 82.5 ],
       [118.67],
       [149.67],
       [108.67],
       [110.  ],
       [130.33],
       [102.  ],
       [ 93.67],
       [ 71.67],
       [ 88.5 ],
       [ 80.5 ],
       [ 80.  ],
       [ 83.5 ],
       [146.  ],
       [118.33],
       [100.67],
       [ 99.33],
       [ 98.67],
       [ 94.67],
       [102.33],
       [ 84.  ],
       [ 84.  ],
       [ 81.  ],
       [ 89.67],
       [ 70.67],
       [ 83.5 ],
       [113.33],
       [112.67],
       [ 89.  ],
       [ 90.5 ],
       [158.33],
       [162.  ],
       [139.  ],
       [119.67],
       [132.  ],
       [144.5 ],
       [140.5 ],
       [136.  ],
       [117.  ],
       [134.  ]]), np.array([[114.5],
       [111. ],
       [160. ],
       [215. ],
       [137.5],
       [139. ],
       [125.5],
       [123. ],
       [121.5],
       [121. ],
       [117.5],
       [ 89. ],
       [123. ],
       [124. ],
       [120. ],
       [134. ],
       [137.5],
       [140. ],
       [110. ],
       [110.5],
       [113. ],
       [108.5],
       [123.5],
       [124. ],
       [125.5],
       [115. ],
       [109. ],
       [101.5],
       [ 98. ],
       [100.5],
       [105. ],
       [ 98. ],
       [113. ],
       [106. ],
       [133. ],
       [161. ],
       [125. ],
       [113.5],
       [109. ],
       [115.5],
       [ 98. ],
       [113. ],
       [104. ],
       [ 98. ],
       [ 93.5],
       [157.5],
       [110. ],
       [ 95.5],
       [109.5],
       [ 90.5],
       [ 86. ],
       [135. ],
       [ 98. ],
       [100. ],
       [111. ],
       [ 87. ],
       [ 81.5],
       [103. ],
       [203.5],
       [132.5],
       [249.5],
       [246. ],
       [176. ],
       [147. ]]), np.array([[155.  ],
       [137.  ],
       [138.  ],
       [106.  ],
       [115.  ],
       [ 94.  ],
       [ 89.  ],
       [ 83.  ],
       [107.  ],
       [105.  ],
       [ 86.  ],
       [112.  ],
       [113.  ],
       [130.  ],
       [131.  ],
       [110.  ],
       [ 92.  ],
       [142.  ],
       [115.  ],
       [ 95.  ],
       [111.  ],
       [ 90.  ],
       [ 95.  ],
       [105.  ],
       [126.  ],
       [127.  ],
       [110.  ],
       [108.  ],
       [ 86.  ],
       [110.  ],
       [ 97.  ],
       [152.  ],
       [140.  ],
       [178.  ],
       [102.  ],
       [186.  ],
       [168.  ],
       [139.  ],
       [147.  ],
       [127.  ],
       [188.  ],
       [186.  ],
       [125.  ],
       [153.  ],
       [260.  ],
       [ 98.  ],
       [140.  ],
       [296.  ],
       [259.  ],
       [196.  ],
       [173.  ],
       [159.  ],
       [156.  ],
       [151.  ],
       [148.  ],
       [185.5 ],
       [154.67],
       [ 91.33],
       [246.33],
       [233.67],
       [221.67],
       [228.67],
       [106.  ],
       [163.  ]]), np.array([[239.5 ],
       [280.4 ],
       [206.6 ],
       [178.2 ],
       [182.2 ],
       [ 97.  ],
       [187.4 ],
       [124.8 ],
       [ 86.  ],
       [ 75.  ],
       [122.5 ],
       [104.5 ],
       [244.4 ],
       [146.  ],
       [208.6 ],
       [ 60.8 ],
       [160.6 ],
       [ 41.2 ],
       [ 66.5 ],
       [202.4 ],
       [191.8 ],
       [175.4 ],
       [167.  ],
       [209.2 ],
       [215.2 ],
       [215.  ],
       [213.4 ],
       [100.  ],
       [100.  ],
       [ 79.4 ],
       [ 56.  ],
       [200.8 ],
       [179.8 ],
       [109.6 ],
       [159.2 ],
       [188.6 ],
       [186.8 ],
       [127.6 ],
       [196.4 ],
       [237.8 ],
       [170.8 ],
       [ 80.  ],
       [204.4 ],
       [206.2 ],
       [188.  ],
       [170.8 ],
       [ 98.  ],
       [120.6 ],
       [228.8 ],
       [243.  ],
       [148.8 ],
       [ 84.2 ],
       [198.  ],
       [126.  ],
       [231.4 ],
       [160.  ],
       [137.5 ],
       [164.67],
       [115.33],
       [172.33],
       [254.4 ],
       [291.75],
       [230.  ],
       [193.4 ]]), np.array([[171.5 ],
       [225.  ],
       [178.  ],
       [166.8 ],
       [270.8 ],
       [298.6 ],
       [182.6 ],
       [203.4 ],
       [111.2 ],
       [195.25],
       [172.8 ],
       [219.2 ],
       [155.5 ],
       [298.  ],
       [249.2 ],
       [211.  ],
       [ 96.2 ],
       [222.4 ],
       [182.6 ],
       [197.8 ],
       [ 75.6 ],
       [225.4 ],
       [207.5 ],
       [211.  ],
       [126.25],
       [112.  ],
       [ 86.  ],
       [ 94.  ],
       [ 84.  ],
       [ 99.  ],
       [108.  ],
       [ 92.  ],
       [ 71.  ],
       [ 65.  ],
       [208.  ],
       [122.  ],
       [159.  ],
       [109.  ],
       [121.  ],
       [130.  ],
       [ 88.  ],
       [185.  ],
       [148.  ],
       [163.  ],
       [163.  ],
       [104.  ],
       [ 89.  ],
       [ 75.  ],
       [ 89.  ],
       [ 66.  ],
       [ 86.  ],
       [ 97.  ],
       [ 69.  ],
       [120.33],
       [116.  ],
       [132.  ],
       [125.5 ],
       [115.  ],
       [164.67],
       [152.67],
       [117.67],
       [131.67],
       [130.  ],
       [113.5 ]]), np.array([[148.67],
       [161.  ],
       [176.  ],
       [115.  ],
       [164.5 ],
       [152.67],
       [180.  ],
       [155.  ],
       [150.  ],
       [167.5 ],
       [172.5 ],
       [221.  ],
       [152.33],
       [179.33],
       [175.  ],
       [202.  ],
       [189.  ],
       [168.33],
       [162.33],
       [ 62.12],
       [ 67.25],
       [ 56.25],
       [ 74.12],
       [ 70.62],
       [105.5 ],
       [123.12],
       [ 70.5 ],
       [ 68.5 ],
       [ 60.75],
       [ 52.75],
       [ 71.25],
       [ 74.38],
       [ 70.12],
       [ 76.38],
       [ 81.38],
       [105.5 ],
       [104.25],
       [ 70.25],
       [ 65.38],
       [ 52.75],
       [ 62.12],
       [ 69.75],
       [ 64.62],
       [ 62.  ],
       [ 74.12],
       [ 84.12],
       [ 83.5 ],
       [ 98.12],
       [ 80.25],
       [ 78.38],
       [ 71.25],
       [ 77.5 ],
       [ 87.38],
       [107.25],
       [106.5 ],
       [109.38],
       [108.38],
       [101.12],
       [ 69.38],
       [ 71.12],
       [ 78.5 ],
       [ 79.  ],
       [ 78.5 ],
       [128.67]]), np.array([[129.33],
       [116.  ],
       [ 90.67],
       [ 99.67],
       [121.67],
       [125.67],
       [115.  ],
       [ 93.  ],
       [ 89.  ],
       [ 88.  ],
       [ 87.  ],
       [194.33],
       [168.  ],
       [141.67],
       [117.67],
       [106.  ],
       [124.67],
       [113.  ],
       [ 88.5 ],
       [ 84.  ],
       [ 80.5 ],
       [ 77.  ],
       [ 76.  ],
       [ 92.  ],
       [102.67],
       [ 80.5 ],
       [ 73.5 ],
       [ 70.  ],
       [ 75.5 ],
       [ 83.5 ],
       [ 87.5 ],
       [ 83.  ],
       [ 81.  ],
       [ 78.  ],
       [ 90.  ],
       [110.  ],
       [102.  ],
       [110.  ],
       [103.  ],
       [ 87.  ],
       [ 83.  ],
       [ 95.  ],
       [ 84.  ],
       [ 83.5 ],
       [ 80.5 ],
       [ 82.  ],
       [ 76.  ],
       [138.5 ],
       [ 96.5 ],
       [ 97.5 ],
       [168.  ],
       [163.  ],
       [145.  ],
       [153.  ],
       [139.  ],
       [135.  ],
       [138.  ],
       [107.  ],
       [107.  ],
       [ 99.  ],
       [ 97.  ],
       [ 80.  ],
       [141.  ],
       [133.67]]), np.array([[152.  ],
       [ 55.5 ],
       [ 70.  ],
       [ 67.  ],
       [ 64.  ],
       [ 64.  ],
       [ 73.  ],
       [ 84.  ],
       [ 86.  ],
       [ 88.  ],
       [ 98.  ],
       [112.  ],
       [117.  ],
       [122.  ],
       [148.  ],
       [136.  ],
       [132.  ],
       [100.  ],
       [ 90.  ],
       [ 84.  ],
       [ 76.  ],
       [ 69.  ],
       [ 66.  ],
       [ 60.  ],
       [ 60.  ],
       [ 57.  ],
       [ 57.  ],
       [ 56.  ],
       [ 59.  ],
       [ 60.  ],
       [ 57.  ],
       [ 56.  ],
       [ 56.  ],
       [ 62.  ],
       [ 64.  ],
       [ 65.  ],
       [ 61.  ],
       [ 61.  ],
       [ 57.  ],
       [ 57.  ],
       [ 51.  ],
       [104.33],
       [ 54.  ],
       [ 57.  ],
       [ 53.  ],
       [102.67],
       [ 54.  ],
       [ 60.  ],
       [ 60.  ],
       [ 60.  ],
       [ 67.  ],
       [ 67.  ],
       [ 78.  ],
       [ 80.  ],
       [102.  ],
       [119.  ],
       [138.  ],
       [132.  ],
       [ 99.  ],
       [100.  ],
       [101.  ],
       [ 92.  ],
       [ 92.  ],
       [ 92.  ]]), np.array([[ 90.  ],
       [ 77.  ],
       [ 67.  ],
       [ 66.  ],
       [ 69.  ],
       [ 63.  ],
       [ 73.  ],
       [ 69.  ],
       [ 68.  ],
       [ 76.  ],
       [ 83.  ],
       [ 84.  ],
       [100.  ],
       [107.  ],
       [107.  ],
       [142.  ],
       [132.  ],
       [116.  ],
       [102.  ],
       [ 88.  ],
       [ 66.  ],
       [ 80.  ],
       [ 74.  ],
       [ 70.  ],
       [ 60.  ],
       [ 71.  ],
       [ 75.  ],
       [100.  ],
       [ 88.  ],
       [146.  ],
       [142.  ],
       [136.  ],
       [120.  ],
       [138.  ],
       [104.  ],
       [ 99.  ],
       [ 94.  ],
       [ 95.  ],
       [ 83.  ],
       [ 79.  ],
       [ 72.  ],
       [ 76.  ],
       [ 73.  ],
       [ 77.  ],
       [ 72.  ],
       [ 67.  ],
       [ 70.  ],
       [ 70.  ],
       [216.  ],
       [266.  ],
       [227.5 ],
       [152.  ],
       [148.5 ],
       [ 94.5 ],
       [106.  ],
       [ 87.  ],
       [107.17],
       [101.67],
       [ 98.  ],
       [ 95.17],
       [116.83],
       [103.  ],
       [104.  ],
       [103.75]]), np.array([[ 95.25],
       [107.5 ],
       [111.5 ],
       [102.  ],
       [113.25],
       [126.25],
       [113.5 ],
       [119.75],
       [127.  ],
       [104.5 ],
       [ 77.33],
       [ 78.  ],
       [118.  ],
       [116.5 ],
       [116.5 ],
       [112.75],
       [103.5 ],
       [106.75],
       [102.75],
       [112.75],
       [108.75],
       [116.25],
       [ 89.25],
       [101.  ],
       [101.25],
       [125.5 ],
       [104.5 ],
       [111.25],
       [130.67],
       [102.  ],
       [102.5 ],
       [111.67],
       [105.5 ],
       [211.  ],
       [147.5 ],
       [142.  ],
       [131.5 ],
       [119.  ],
       [109.  ],
       [ 99.  ],
       [100.  ],
       [ 93.  ],
       [ 91.  ],
       [ 94.  ],
       [ 91.  ],
       [ 92.  ],
       [ 86.  ],
       [ 93.  ],
       [ 92.  ],
       [100.  ],
       [109.  ],
       [109.  ],
       [119.  ],
       [ 59.5 ],
       [173.33],
       [139.67],
       [ 94.  ],
       [112.67],
       [116.  ],
       [118.33],
       [ 89.5 ],
       [112.5 ],
       [121.  ],
       [124.5 ]]), np.array([[105.75],
       [130.5 ],
       [112.75],
       [110.  ],
       [121.25],
       [125.75],
       [123.  ],
       [129.75],
       [129.75],
       [109.5 ],
       [120.25],
       [112.25],
       [111.75],
       [114.75],
       [105.5 ],
       [121.67],
       [121.5 ],
       [130.75],
       [110.75],
       [ 90.  ],
       [ 90.25],
       [111.75],
       [105.5 ],
       [118.25],
       [138.5 ],
       [116.5 ],
       [143.25],
       [ 98.  ],
       [ 74.  ],
       [136.  ],
       [100.  ],
       [ 92.  ],
       [117.  ],
       [165.  ],
       [146.  ],
       [140.  ],
       [205.  ],
       [170.  ],
       [162.  ],
       [134.  ],
       [137.  ],
       [137.  ],
       [125.  ],
       [115.  ],
       [110.  ],
       [112.  ],
       [ 73.  ],
       [107.25],
       [139.  ],
       [ 89.75],
       [ 68.5 ],
       [ 61.75],
       [ 60.5 ],
       [106.  ],
       [ 94.75],
       [ 79.5 ],
       [ 64.25],
       [ 61.  ],
       [ 86.5 ],
       [111.25],
       [126.  ],
       [140.  ],
       [159.  ],
       [172.  ]]), np.array([[122.5 ],
       [104.75],
       [ 87.5 ],
       [ 68.  ],
       [ 62.25],
       [137.75],
       [157.  ],
       [175.75],
       [174.5 ],
       [116.75],
       [ 99.5 ],
       [ 88.5 ],
       [ 74.25],
       [ 60.5 ],
       [ 77.  ],
       [ 92.25],
       [103.  ],
       [179.75],
       [165.75],
       [145.75],
       [ 98.  ],
       [156.5 ],
       [142.25],
       [117.  ],
       [100.5 ],
       [ 97.5 ],
       [ 85.75],
       [ 82.25],
       [108.75],
       [116.75],
       [108.5 ],
       [135.5 ],
       [138.5 ],
       [144.  ],
       [161.25],
       [166.5 ],
       [152.5 ],
       [163.25],
       [148.  ],
       [132.5 ],
       [123.25],
       [109.5 ],
       [ 91.25],
       [ 87.75],
       [ 81.  ],
       [ 75.5 ],
       [ 72.75],
       [ 74.75],
       [100.5 ],
       [ 78.5 ],
       [153.75],
       [197.25],
       [187.75],
       [209.25],
       [157.75],
       [153.25],
       [119.25],
       [ 93.25],
       [ 95.75],
       [ 83.25],
       [ 72.25],
       [ 75.75],
       [ 73.  ],
       [ 67.5 ]]), np.array([[ 60.  ],
       [ 61.5 ],
       [ 62.75],
       [ 60.  ],
       [ 66.75],
       [ 59.5 ],
       [ 83.  ],
       [ 65.5 ],
       [ 59.5 ],
       [ 99.  ],
       [131.25],
       [167.5 ],
       [164.5 ],
       [142.25],
       [110.75],
       [107.5 ],
       [ 93.  ],
       [ 78.  ],
       [ 73.  ],
       [ 66.5 ],
       [ 74.  ],
       [ 61.25],
       [ 59.25],
       [ 59.5 ],
       [ 61.75],
       [ 58.  ],
       [109.25],
       [153.5 ],
       [149.  ],
       [205.5 ],
       [180.  ],
       [169.75],
       [155.  ],
       [153.5 ],
       [124.75],
       [125.25],
       [115.5 ],
       [ 84.75],
       [128.5 ],
       [107.5 ],
       [113.5 ],
       [ 85.75],
       [ 74.  ],
       [ 75.  ],
       [132.  ],
       [138.  ],
       [135.5 ],
       [123.5 ],
       [114.  ],
       [156.  ],
       [166.  ],
       [154.  ],
       [143.  ],
       [143.  ],
       [138.  ],
       [137.  ],
       [144.  ],
       [145.  ],
       [128.  ],
       [146.  ],
       [148.  ],
       [145.  ],
       [137.  ],
       [135.  ]]), np.array([[123.  ],
       [132.5 ],
       [122.5 ],
       [129.  ],
       [154.5 ],
       [110.5 ],
       [151.  ],
       [149.  ],
       [154.  ],
       [134.  ],
       [141.  ],
       [135.  ],
       [136.  ],
       [133.  ],
       [137.  ],
       [128.  ],
       [131.  ],
       [142.  ],
       [145.  ],
       [128.  ],
       [139.  ],
       [133.  ],
       [152.  ],
       [127.  ],
       [173.5 ],
       [133.5 ],
       [125.5 ],
       [129.5 ],
       [128.5 ],
       [175.  ],
       [147.  ],
       [120.  ],
       [153.  ],
       [180.  ],
       [128.  ],
       [146.  ],
       [140.  ],
       [138.  ],
       [145.  ],
       [151.  ],
       [132.  ],
       [125.  ],
       [128.  ],
       [139.5 ],
       [137.  ],
       [137.5 ],
       [136.  ],
       [135.  ],
       [137.5 ],
       [129.  ],
       [123.5 ],
       [164.  ],
       [164.  ],
       [165.  ],
       [146.  ],
       [149.  ],
       [ 99.67],
       [ 95.33],
       [ 84.  ],
       [ 99.  ],
       [ 83.  ],
       [ 79.  ],
       [ 79.  ],
       [ 75.  ]]), np.array([[111.  ],
       [122.  ],
       [106.  ],
       [114.  ],
       [ 93.  ],
       [ 92.  ],
       [103.  ],
       [102.  ],
       [111.  ],
       [111.  ],
       [106.  ],
       [ 95.  ],
       [ 96.  ],
       [ 84.  ],
       [ 95.  ],
       [ 98.75],
       [ 88.5 ],
       [ 81.5 ],
       [ 75.75],
       [ 68.75],
       [ 83.  ],
       [ 89.25],
       [107.  ],
       [125.25],
       [ 87.  ],
       [ 85.  ],
       [ 87.  ],
       [ 86.  ],
       [ 82.  ],
       [120.  ],
       [106.  ],
       [110.  ],
       [125.  ],
       [129.  ],
       [110.  ],
       [ 90.  ],
       [ 95.  ],
       [120.  ],
       [ 88.  ],
       [ 81.  ],
       [ 93.  ],
       [ 85.  ],
       [ 89.  ],
       [214.  ],
       [144.  ],
       [151.  ],
       [151.  ],
       [106.5 ],
       [120.  ],
       [103.  ],
       [116.5 ],
       [ 91.  ],
       [105.  ],
       [ 96.  ],
       [ 86.25],
       [113.67],
       [106.  ],
       [ 98.6 ],
       [136.5 ],
       [152.4 ],
       [146.2 ],
       [124.  ],
       [ 95.  ],
       [ 84.  ]]), np.array([[ 85.  ],
       [180.  ],
       [153.  ],
       [ 96.  ],
       [101.  ],
       [ 88.  ],
       [ 98.  ],
       [ 92.  ],
       [ 86.  ],
       [188.  ],
       [107.  ],
       [104.  ],
       [ 99.  ],
       [ 93.  ],
       [ 92.  ],
       [ 87.  ],
       [ 88.  ],
       [ 84.  ],
       [160.  ],
       [125.  ],
       [ 85.  ],
       [ 87.  ],
       [ 88.  ],
       [ 89.  ],
       [ 87.  ],
       [ 82.  ],
       [150.  ],
       [148.  ],
       [109.  ],
       [102.  ],
       [ 90.  ],
       [120.  ],
       [128.83],
       [ 90.5 ],
       [ 92.5 ],
       [ 72.5 ],
       [ 68.5 ],
       [ 65.  ],
       [ 94.5 ],
       [ 92.  ],
       [ 87.  ],
       [ 93.  ],
       [ 98.5 ],
       [124.5 ],
       [123.  ],
       [171.5 ],
       [135.  ],
       [118.  ],
       [105.  ],
       [ 93.  ],
       [ 78.5 ],
       [ 61.5 ],
       [127.  ],
       [123.  ],
       [128.5 ],
       [143.  ],
       [142.83],
       [113.5 ],
       [116.  ],
       [109.83],
       [ 88.5 ],
       [ 65.  ],
       [ 67.  ],
       [120.5 ]]), np.array([[122.  ],
       [149.  ],
       [165.5 ],
       [140.5 ],
       [114.  ],
       [139.33],
       [114.  ],
       [ 58.5 ],
       [103.5 ],
       [ 83.5 ],
       [ 86.5 ],
       [ 84.5 ],
       [130.5 ],
       [142.  ],
       [155.5 ],
       [141.5 ],
       [132.5 ],
       [113.5 ],
       [ 99.  ],
       [ 91.  ],
       [ 83.  ],
       [ 82.  ],
       [157.75],
       [171.25],
       [151.25],
       [127.33],
       [113.75],
       [102.25],
       [100.5 ],
       [ 86.5 ],
       [116.33],
       [140.25],
       [154.25],
       [154.25],
       [112.  ],
       [177.75],
       [164.25],
       [138.5 ],
       [125.  ],
       [103.5 ],
       [ 95.75],
       [ 93.  ],
       [ 77.  ],
       [ 95.  ],
       [ 98.  ],
       [120.  ],
       [102.  ],
       [ 87.  ],
       [ 84.  ],
       [138.  ],
       [103.  ],
       [111.  ],
       [ 98.  ],
       [ 80.  ],
       [ 90.  ],
       [ 85.  ],
       [ 98.  ],
       [106.  ],
       [196.  ],
       [109.  ],
       [ 79.  ],
       [100.  ],
       [ 97.  ],
       [ 95.  ]]), np.array([[ 76.  ],
       [100.  ],
       [108.  ],
       [122.5 ],
       [110.5 ],
       [ 98.5 ],
       [173.75],
       [114.5 ],
       [136.67],
       [ 97.67],
       [116.  ],
       [ 91.75],
       [ 89.5 ],
       [ 95.17],
       [ 77.17],
       [109.5 ],
       [106.5 ],
       [105.  ],
       [102.5 ],
       [103.5 ],
       [ 99.5 ],
       [ 98.5 ],
       [ 96.5 ],
       [121.33],
       [120.33],
       [118.  ],
       [124.  ],
       [129.  ],
       [131.67],
       [132.  ],
       [126.  ],
       [118.33],
       [116.  ],
       [122.67],
       [108.  ],
       [109.  ],
       [104.  ],
       [ 98.5 ],
       [101.5 ],
       [ 88.  ],
       [138.33],
       [115.33],
       [132.67],
       [133.5 ],
       [237.87],
       [278.41],
       [222.55],
       [238.79],
       [228.95],
       [199.3 ],
       [147.37],
       [133.37],
       [116.9 ],
       [114.45],
       [103.75],
       [ 89.99],
       [ 79.46],
       [ 77.13],
       [ 72.14],
       [ 71.35],
       [134.  ],
       [112.  ],
       [109.  ],
       [123.  ]]), 
    np.array([[118. ],
       [121. ],
       [129. ],
       [113.5],
       [146. ],
       [135. ],
       [126. ],
       [148. ],
       [114. ],
       [127. ],
       [118.5],
       [121. ],
       [110.5],
       [127. ],
       [107.5],
       [151. ],
       [129. ],
       [134. ],
       [131. ],
       [120. ],
       [136. ],
       [127.5],
       [120.5],
       [135.5],
       [145. ],
       [128. ],
       [172. ],
       [152. ],
       [132. ],
       [148. ],
       [120. ],
       [144. ],
       [123.5],
       [132.5],
       [135. ],
       [118.5],
       [144. ],
       [149. ]])]

# %%
for count_ in np.arange(len(a)):
    print (len(a[count_]))

# %%
np.array(a).flatten()

# %%
a[0].flatten()

# %%
b = a.copy()

# %%
for count_ in np.arange(len(a)):
    a[count_] = a[count_].flatten()

# %%
len(a)

# %%
